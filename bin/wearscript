#!/usr/bin/env python2

import wearscript
import argparse

def callback(ws, **kw):
    if kw['card']:
        ws.send(
            'startScript',
            """
            <script>
              WS.wake();
              WS.activityCreate();
              WS.displayCardScroll();
              WS.cardInsert(0, WS.cardFactory('%s', 'WearScript'));
            </script>
            """ % (kw['card'])
        )
    if kw['say']:
        ws.send('startScript',"<script>WS.say('%s')</script>" % kw['say'])
    if (kw['start'] or kw['save']):
        script_name = kw['start'] or kw['save']
        with open (script_name, "r") as script:
            script_data=script.read()
        if kw['start']:
            ws.send('startScript',script_data)
        if kw['save']:
            ws.send('saveScript',script_data,kw['save'].split('.')[0])

parser = argparse.ArgumentParser()
parser.add_argument('--say')
parser.add_argument('--card')
parser.add_argument('--start')
parser.add_argument('--save')
wearscript.parse(callback,parser)
